View(vh)
vh <- vote_history
vh2 <- vote_history %>%
filter(
season == 40,
episode == 10
)
View(vh2)
View(vh2)
vh2 <- vote_history %>%
tabyl(vote)
library(janitor)
install.packages("janitor")
library(janitor)
vh2 <- vote_history %>%
tabyl(vote)
View(vh2)
vh2 <- vote_history %>%
tabyl(season,vote)
View(vh2)
vh31 <- vote_history %>%
filter(
season == 31,
episode == 10
)
vh23 <- vote_history %>%
filter(
season == 23,
episode == 10
)
View(vh23)
vh31 <- vote_history %>%
filter(
season == 31
)
vh23 <- vote_history %>%
filter(
season == 23
)
distinct(vh23, castaway)
castaways31 <- distinct(vh31, castaway)
castaways23 <- distinct(vh23, castaway)
View(vh31)
View(castaways31)
vh4 <- vote_history %>%
filter(
season == 4
)
castaways4 <- distinct(vh4, castaway)
singep <- vote_history %>%
filter(
season == 31, episode == 1
)
View(singep)
inner_join(singep, singep, by = NULL, copy = FALSE)
tets <- inner_join(singep, singep, by = NULL, copy = FALSE)
View(tets)
tets <- inner_join(singep, singep, by = c(singep.episode=singep.episode), copy = FALSE)
View(singep)
tets <- inner_join(singep, singep, by = c("episode"="episode"), copy = FALSE)
View(tets)
episodes4 <- distinct(vh4, episode)
episodes31 <- distinct(vh31, episode)
View(episodes4)
#Get episode lists
episodes4 <- distinct(vh4, season, episode)
View(castaways4)
View(episodes4)
#Get episode lists
episodes4 <- distinct(vh4, season, episode)
episodes31 <- distinct(vh31, season, episode)
#All combos
cross_join(episodes4, castaways4)
#All combos
outer_join(episodes4, castaways4)
#All combos
inner_join(episodes4, castaways4)
#All combos
inner_join(episodes4, castaways4, by=NULL)
#All combos
inner_join(episodes4, castaways4, by=character())
allcombos31 <- inner_join(episodes31, castaways31, by=character())
allcombos31 <- inner_join(episodes31, castaways31, by=character())
tets <- inner_join(allcombos4, singep, by = NULL, copy = FALSE)
#All combos
allcombos4 <- inner_join(episodes4, castaways4, by=character())
tets <- inner_join(allcombos4, singep, by = NULL, copy = FALSE)
tets <- inner_join(allcombos31, singep, by = NULL, copy = FALSE)
View(tets)
tets <- left_join(allcombos31, singep, by = NULL, copy = FALSE)
bothvotes <- left_join(firstvote, singep, by = c("season"="season", "episode"="episode"), copy = FALSE)
firstvote <- left_join(allcombos31, singep, by = NULL, copy = FALSE)
bothvotes <- left_join(firstvote, singep, by = c("season"="season", "episode"="episode"), copy = FALSE)
View(bothvotes)
bothvotes %>%
mutate(
g = ifelse(vote.x==vote.y, "Allies", "Not")
)
test <- bothvotes %>%
mutate(
g = ifelse(vote.x==vote.y, "Allies", "Not")
)
View(singep)
View(test)
adjacencymatrix_stg <- bothvotes %>%
mutate(
allies = ifelse(vote.x==vote.y, 1, 0)
)
adjacencymatrix_stg <- bothvotes %>%
mutate(
votedtogether = ifelse(vote.x==vote.y, 1, 0)
)
adjacencymatrix_stg2 <- adjacencymatrix_stg %>%
select(season, episode, castaway.x, castaway.y, votedtogether)
View(adjacencymatrix_stg2)
#Find adjacency matrix by episode
firstvote <- left_join(allcombos31, vh31, by = NULL, copy = FALSE)
bothvotes <- left_join(firstvote, vh31, by = c("season"="season", "episode"="episode"), copy = FALSE)
adjacencymatrix_stg <- bothvotes %>%
mutate(
votedtogether = ifelse(vote.x==vote.y, 1, 0)
)
adjacencymatrix_stg2 <- adjacencymatrix_stg %>%
select(season, episode, castaway.x, castaway.y, votedtogether)
View(adjacencymatrix_stg2)
View(vh31)
#Get episode lists
episodes4 <- distinct(vh4, season, episode, day)
episodes31 <- distinct(vh31, season, episode, day)
#All combos
allcombos4 <- inner_join(episodes4, castaways4, by=character())
allcombos31 <- inner_join(episodes31, castaways31, by=character())
#Find adjacency matrix by episode
firstvote <- left_join(allcombos31, vh31, by = NULL, copy = FALSE)
bothvotes <- left_join(firstvote, vh31, by = c("season"="season", "episode"="episode", "day"="day"), copy = FALSE)
adjacencymatrix_stg <- bothvotes %>%
mutate(
votedtogether = ifelse(vote.x==vote.y, 1, 0)
)
adjacencymatrix_stg2 <- adjacencymatrix_stg %>%
select(season, episode, day, castaway.x, castaway.y, votedtogether)
write.csv(adjacencymatrix_stg2, "C:\\Users\\13362\\Survivor\\adjacency31.csv"
write.csv(adjacencymatrix_stg2, "C:\\Users\\13362\\Survivor\\adjacency31.csv")
View(adjacencymatrix_stg2)
write.csv(adjacencymatrix_stg2, "C:\\Users\\13362\\Survivor\\adjacency31.csv")
bothvotes <- left_join(firstvote, firstvote, by = c("season"="season", "episode"="episode", "day"="day"), copy = FALSE)
adjacencymatrix_stg <- bothvotes %>%
mutate(
votedtogether = ifelse(vote.x==vote.y, 1, 0)
)
adjacencymatrix_stg2 <- adjacencymatrix_stg %>%
select(season, episode, day, castaway.x, castaway.y, votedtogether)
write.csv(adjacencymatrix_stg2, "C:\\Users\\13362\\Survivor\\adjacency31.csv")
View(bothvotes)
adjacencymatrix <- adjacencymatrix_stg2 %>%
replace_na(0)
adjacencymatrix <- adjacencymatrix_stg2 %>%
replace_na(votedtogether, 0)
adjacencymatrix <- adjacencymatrix_stg2 %>%
replace_na(votedtogether = 0)
adjacencymatrix <- adjacencymatrix_stg2 %>%
replace_na(list(votedtogether = 0))
View(adjacencymatrix)
write.csv(adjacencymatrix, "C:\\Users\\13362\\Survivor\\adjacency31.csv")
#Read in detour and delay distribution data
abcgdata <- read_csv('orderhist_abcg.csv')
otddata <- read_csv('orderhist_otd.csv')
rrdata <- read_csv('orderhist_rr.csv')
#---------------------------------------------------------------#
#---------------------------------------------------------------#
joineddata <- full_join(abcgdata, otddata, by = "orderid") %>%
select(orderid, orderdetour.x, orderdetour.y)
joineddata <- rename(joineddata, detour_abcg = orderdetour.x)
joineddata <- rename(joineddata, detour_otd = orderdetour.y)
joineddata <- full_join(joineddata, rrdata, by = "orderid") %>%
select(orderid, detour_abcg, detour_otd, orderdetour)
joineddata <- rename(joineddata, detour_rr = orderdetour)
vec_mvg <- rep("RPDP/MAG", 831)
vec_otd <- rep("Orders-then-drivers", 831)
vec_rr <- rep("Orders-then-drivers (two-stage)", 831)
mvghist <- joineddata %>% select(orderid, detour_abcg)
otdhist <- joineddata %>% select(orderid, detour_otd)
rrhist <- joineddata %>% select(orderid, detour_rr)
mvghist <- rename(mvghist, orderdetour = detour_abcg)
otdhist <- rename(otdhist, orderdetour = detour_otd)
rrhist <- rename(rrhist, orderdetour = detour_rr)
mvghist <- mvghist %>%
mutate(datalabel = vec_mvg)
otdhist <- otdhist %>%
mutate(datalabel = vec_otd)
rrhist <- rrhist %>%
mutate(datalabel = vec_rr)
alldata = rbind(mvghist, rrhist)
alldata$datalabel <- factor(alldata$datalabel,
levels=c("RPDP/MAG", "Orders-then-drivers", "Orders-then-drivers (two-stage) "),
labels=c("RPDP/MAG", "Orders-then-drivers", "Orders-then-drivers (two-stage) "))
alldata <- subset(alldata, !is.na(orderdetour))
mean_detour <- alldata %>%
group_by(datalabel) %>%
summarize(mean=mean(orderdetour))
#---------------------------------------------------------------#
#Detour
update_geom_defaults("text", list(size = 48))
dev.new(width=8, height=4)
png(file="detourdensity_leg2.png", width=900, height=1200)
# width=450, height=600)
alldata %>%
ggplot(aes(x=orderdetour, color=datalabel, fill=datalabel)) +
geom_density(alpha=0.3,size=1)+
geom_vline(data = mean_detour, aes(xintercept = mean,
color = datalabel), size=1.5)+
#xlim(0, 0.00000001)+
#ylim(0, 100)+
scale_colour_manual("",
breaks = c("RPDP/MAG", "Orders-then-drivers (two-stage) "),
values = c("#DA853E", "#649BCB"))+
scale_fill_manual("", breaks = c("RPDP/MAG", "Orders-then-drivers (two-stage) "),
values = c("#DA853E", "#649BCB")) +
labs(x="Detour (as % of shortest path)", y="Density")+
scale_x_continuous(limits=c(0,0.15), labels = scales::percent_format(accuracy = 1)) +
#theme(legend.position="none") +
theme(legend.position="bottom", legend.text = element_text(size = 30)) +
theme(axis.text = element_text(size = 30)) +
theme(axis.title = element_text(size = 30))
dev.off()
setwd("C:/Users/13362/repos/relaylogistics/figures/onlinehistograms")
library(shiny)
library(DT)
library(tidyverse)
#library(leaflet)
#library(lubridate)
library(dplyr)
#Read in detour and delay distribution data
abcgdata <- read_csv('orderhist_abcg.csv')
otddata <- read_csv('orderhist_otd.csv')
rrdata <- read_csv('orderhist_rr.csv')
#---------------------------------------------------------------#
#---------------------------------------------------------------#
joineddata <- full_join(abcgdata, otddata, by = "orderid") %>%
select(orderid, orderdetour.x, orderdetour.y)
joineddata <- rename(joineddata, detour_abcg = orderdetour.x)
joineddata <- rename(joineddata, detour_otd = orderdetour.y)
joineddata <- full_join(joineddata, rrdata, by = "orderid") %>%
select(orderid, detour_abcg, detour_otd, orderdetour)
joineddata <- rename(joineddata, detour_rr = orderdetour)
vec_mvg <- rep("RPDP/MAG", 831)
vec_otd <- rep("Orders-then-drivers", 831)
vec_rr <- rep("Orders-then-drivers (two-stage)", 831)
mvghist <- joineddata %>% select(orderid, detour_abcg)
otdhist <- joineddata %>% select(orderid, detour_otd)
rrhist <- joineddata %>% select(orderid, detour_rr)
mvghist <- rename(mvghist, orderdetour = detour_abcg)
otdhist <- rename(otdhist, orderdetour = detour_otd)
rrhist <- rename(rrhist, orderdetour = detour_rr)
mvghist <- mvghist %>%
mutate(datalabel = vec_mvg)
otdhist <- otdhist %>%
mutate(datalabel = vec_otd)
rrhist <- rrhist %>%
mutate(datalabel = vec_rr)
alldata = rbind(mvghist, rrhist)
alldata$datalabel <- factor(alldata$datalabel,
levels=c("RPDP/MAG", "Orders-then-drivers", "Orders-then-drivers (two-stage) "),
labels=c("RPDP/MAG", "Orders-then-drivers", "Orders-then-drivers (two-stage) "))
alldata <- subset(alldata, !is.na(orderdetour))
mean_detour <- alldata %>%
group_by(datalabel) %>%
summarize(mean=mean(orderdetour))
#---------------------------------------------------------------#
#Detour
update_geom_defaults("text", list(size = 48))
dev.new(width=8, height=4)
png(file="detourdensity_leg2.png", width=900, height=1200)
# width=450, height=600)
alldata %>%
ggplot(aes(x=orderdetour, color=datalabel, fill=datalabel)) +
geom_density(alpha=0.3,size=1)+
geom_vline(data = mean_detour, aes(xintercept = mean,
color = datalabel), size=1.5)+
#xlim(0, 0.00000001)+
#ylim(0, 100)+
scale_colour_manual("",
breaks = c("RPDP/MAG", "Orders-then-drivers (two-stage) "),
values = c("#DA853E", "#649BCB"))+
scale_fill_manual("", breaks = c("RPDP/MAG", "Orders-then-drivers (two-stage) "),
values = c("#DA853E", "#649BCB")) +
labs(x="Detour (as % of shortest path)", y="Density")+
scale_x_continuous(limits=c(0,0.15), labels = scales::percent_format(accuracy = 1)) +
#theme(legend.position="none") +
theme(legend.position="bottom", legend.text = element_text(size = 30)) +
theme(axis.text = element_text(size = 30)) +
theme(axis.title = element_text(size = 30))
dev.off()
#---------------------------------------------------------------#
#Read in detour and delay distribution data
abcgdata <- read_csv('orderhist_abcg.csv')
otddata <- read_csv('orderhist_otd.csv')
rrdata <- read_csv('orderhist_rr.csv')
#---------------------------------------------------------------#
#---------------------------------------------------------------#
joineddata <- full_join(abcgdata, otddata, by = "orderid") %>%
select(orderid, orderdetour.x, orderdetour.y)
joineddata <- rename(joineddata, detour_abcg = orderdetour.x)
joineddata <- rename(joineddata, detour_otd = orderdetour.y)
joineddata <- full_join(joineddata, rrdata, by = "orderid") %>%
select(orderid, detour_abcg, detour_otd, orderdetour)
joineddata <- rename(joineddata, detour_rr = orderdetour)
vec_mvg <- rep("RPDP/MAG", 831)
vec_otd <- rep("Orders-then-drivers", 831)
vec_rr <- rep("Orders-then-drivers (two-stage)", 831)
mvghist <- joineddata %>% select(orderid, detour_abcg)
otdhist <- joineddata %>% select(orderid, detour_otd)
rrhist <- joineddata %>% select(orderid, detour_rr)
mvghist <- rename(mvghist, orderdetour = detour_abcg)
otdhist <- rename(otdhist, orderdetour = detour_otd)
rrhist <- rename(rrhist, orderdetour = detour_rr)
mvghist <- mvghist %>%
mutate(datalabel = vec_mvg)
otdhist <- otdhist %>%
mutate(datalabel = vec_otd)
rrhist <- rrhist %>%
mutate(datalabel = vec_rr)
alldata = rbind(mvghist, rrhist)
alldata$datalabel <- factor(alldata$datalabel,
levels=c("RPDP/MAG", "Orders-then-drivers", "Orders-then-drivers (two-stage) "),
labels=c("RPDP/MAG", "Orders-then-drivers", "Orders-then-drivers (two-stage) "))
alldata <- subset(alldata, !is.na(orderdetour))
mean_detour <- alldata %>%
group_by(datalabel) %>%
summarize(mean=mean(orderdetour))
#---------------------------------------------------------------#
#Detour
update_geom_defaults("text", list(size = 48))
dev.new(width=8, height=4)
png(file="detourdensity_leg2.png", width=900, height=1200)
# width=450, height=600)
alldata %>%
ggplot(aes(x=orderdetour, color=datalabel, fill=datalabel)) +
geom_density(alpha=0.3,size=1)+
geom_vline(data = mean_detour, aes(xintercept = mean,
color = datalabel), size=1.5)+
#xlim(0, 0.00000001)+
#ylim(0, 100)+
scale_colour_manual("",
breaks = c("RPDP/MAG", "Orders-then-drivers (two-stage) "),
values = c("#DA853E", "#649BCB"))+
scale_fill_manual("", breaks = c("RPDP/MAG", "Orders-then-drivers (two-stage) "),
values = c("#DA853E", "#649BCB")) +
labs(x="Detour (as % of shortest path)", y="Density")+
scale_x_continuous(limits=c(0,0.15), labels = scales::percent_format(accuracy = 1)) +
#theme(legend.position="none") +
theme(legend.position="bottom", legend.text = element_text(size = 30)) +
theme(axis.text = element_text(size = 30)) +
theme(axis.title = element_text(size = 30))
dev.off()
#Read in detour and delay distribution data
abcgdata <- read_csv('orderhist_abcg.csv')
otddata <- read_csv('orderhist_otd.csv')
rrdata <- read_csv('orderhist_rr.csv')
joineddata <- full_join(abcgdata, otddata, by = "orderid") %>%
select(orderid, orderdetour.x, orderdetour.y)
joineddata <- rename(joineddata, detour_abcg = orderdetour.x)
joineddata <- rename(joineddata, detour_otd = orderdetour.y)
joineddata <- full_join(joineddata, rrdata, by = "orderid") %>%
select(orderid, detour_abcg, detour_otd, orderdetour)
joineddata <- rename(joineddata, detour_rr = orderdetour)
vec_mvg <- rep("RPDP/MAG", 831)
vec_otd <- rep("Orders-then-drivers", 831)
vec_rr <- rep("Orders-then-drivers (two-stage)", 831)
vec_rr
mvghist <- joineddata %>% select(orderid, detour_abcg)
otdhist <- joineddata %>% select(orderid, detour_otd)
rrhist <- joineddata %>% select(orderid, detour_rr)
mvghist <- rename(mvghist, orderdetour = detour_abcg)
otdhist <- rename(otdhist, orderdetour = detour_otd)
rrhist <- rename(rrhist, orderdetour = detour_rr)
mvghist <- mvghist %>%
mutate(datalabel = vec_mvg)
otdhist <- otdhist %>%
mutate(datalabel = vec_otd)
rrhist <- rrhist %>%
mutate(datalabel = vec_rr)
alldata = rbind(mvghist, rrhist)
alldata$datalabel <- factor(alldata$datalabel,
levels=c("RPDP/MAG", "Orders-then-drivers", "Orders-then-drivers (two-stage) "),
labels=c("RPDP/MAG", "Orders-then-drivers", "Orders-then-drivers (two-stage) "))
alldata
View(alldata)
#Read in detour and delay distribution data
abcgdata <- read_csv('orderhist_abcg.csv')
otddata <- read_csv('orderhist_otd.csv')
rrdata <- read_csv('orderhist_rr.csv')
#---------------------------------------------------------------#
#---------------------------------------------------------------#
joineddata <- full_join(abcgdata, otddata, by = "orderid") %>%
select(orderid, orderdetour.x, orderdetour.y)
joineddata <- rename(joineddata, detour_abcg = orderdetour.x)
joineddata <- rename(joineddata, detour_otd = orderdetour.y)
joineddata <- full_join(joineddata, rrdata, by = "orderid") %>%
select(orderid, detour_abcg, detour_otd, orderdetour)
joineddata <- rename(joineddata, detour_rr = orderdetour)
vec_mvg <- rep("RPDP/MAG", 831)
vec_otd <- rep("Orders-then-drivers", 831)
vec_rr <- rep("Orders-then-drivers (two-stage)", 831)
mvghist <- joineddata %>% select(orderid, detour_abcg)
otdhist <- joineddata %>% select(orderid, detour_otd)
rrhist <- joineddata %>% select(orderid, detour_rr)
mvghist <- rename(mvghist, orderdetour = detour_abcg)
otdhist <- rename(otdhist, orderdetour = detour_otd)
rrhist <- rename(rrhist, orderdetour = detour_rr)
mvghist <- mvghist %>%
mutate(datalabel = vec_mvg)
otdhist <- otdhist %>%
mutate(datalabel = vec_otd)
rrhist <- rrhist %>%
mutate(datalabel = vec_rr)
alldata = rbind(mvghist, rrhist)
alldata
View(alldata)
alldata <- subset(alldata, !is.na(orderdetour))
mean_detour <- alldata %>%
group_by(datalabel) %>%
summarize(mean=mean(orderdetour))
#Detour
update_geom_defaults("text", list(size = 48))
dev.new(width=8, height=4)
png(file="detourdensity_leg2.png", width=900, height=1200)
# width=450, height=600)
alldata %>%
ggplot(aes(x=orderdetour, color=datalabel, fill=datalabel)) +
geom_density(alpha=0.3,size=1)+
geom_vline(data = mean_detour, aes(xintercept = mean,
color = datalabel), size=1.5)+
#xlim(0, 0.00000001)+
#ylim(0, 100)+
scale_colour_manual("",
breaks = c("RPDP/MAG", "Orders-then-drivers (two-stage) "),
values = c("#DA853E", "#649BCB"))+
scale_fill_manual("", breaks = c("RPDP/MAG", "Orders-then-drivers (two-stage) "),
values = c("#DA853E", "#649BCB")) +
labs(x="Detour (as % of shortest path)", y="Density")+
scale_x_continuous(limits=c(0,0.15), labels = scales::percent_format(accuracy = 1)) +
#theme(legend.position="none") +
theme(legend.position="bottom", legend.text = element_text(size = 30)) +
theme(axis.text = element_text(size = 30)) +
theme(axis.title = element_text(size = 30))
dev.off()
#Detour
update_geom_defaults("text", list(size = 48))
dev.new(width=8, height=4)
png(file="detourdensity_leg2.png", width=900, height=1200)
# width=450, height=600)
alldata %>%
ggplot(aes(x=orderdetour, color=datalabel, fill=datalabel)) +
geom_density(alpha=0.3,size=1)+
geom_vline(data = mean_detour, aes(xintercept = mean,
color = datalabel), size=1.5)+
#xlim(0, 0.00000001)+
#ylim(0, 100)+
scale_colour_manual("",
breaks = c("RPDP/MAG", "Orders-then-drivers (two-stage)"),
values = c("#DA853E", "#649BCB"))+
scale_fill_manual("", breaks = c("RPDP/MAG", "Orders-then-drivers (two-stage)"),
values = c("#DA853E", "#649BCB")) +
labs(x="Detour (as % of shortest path)", y="Density")+
scale_x_continuous(limits=c(0,0.15), labels = scales::percent_format(accuracy = 1)) +
#theme(legend.position="none") +
theme(legend.position="bottom", legend.text = element_text(size = 30)) +
theme(axis.text = element_text(size = 30)) +
theme(axis.title = element_text(size = 30))
dev.off()
setwd("C:/Users/13362/repos/relaylogistics/scripts/rscripts/deliverytimeshist")
library(shiny)
library(DT)
library(tidyverse)
library(dplyr)
#---------------------------------------------------------------#
#Read in data
ptpdata <- read_csv('ex4_exp64_ptp_rundate2024-06-13_deliverytimes.csv')
relaydata <- read_csv('ex4_exp69_relay_rundate2024-06-13_deliverytimes.csv')
#---------------------------------------------------------------#
#Filter to orders completed in both runs
#---------------------------------------------------------------#
relaydata1 <- relaydata %>% select(id, order, actual)
vec1 <- rep("Actual delivery time", nrow(relaydata1))
relaydata1 <- relaydata1 %>% mutate(datalabel = vec1)
relaydata1 <- rename(relaydata1, deliverytime = actual)
relaydata2 <- relaydata %>% select(id, order, best)
vec2 <- rep("Best delivery time", nrow(relaydata2))
relaydata2 <- relaydata2 %>% mutate(datalabel = vec2)
relaydata2 <- rename(relaydata2, deliverytime = best)
relaydata <- rbind(relaydata1, relaydata2)
#---------------------------------------------------------------#
relaymeandelivtime <- relaydata %>%
group_by(datalabel) %>%
summarize(mean=mean(deliverytime))
relaymeandelivtime
ptpdata <- read_csv('ex4_exp64_ptp_rundate2024-06-13_deliverytimes.csv')
ptpdata1 <- ptpdata %>% select(id, order, actual)
vec1 <- rep("Actual delivery time", nrow(ptpdata1))
ptpdata1 <- ptpdata1 %>% mutate(datalabel = vec1)
ptpdata1 <- rename(ptpdata1, deliverytime = actual)
ptpdata2 <- ptpdata %>% select(id, order, best)
vec2 <- rep("Best delivery time", nrow(ptpdata2))
ptpdata2 <- ptpdata2 %>% mutate(datalabel = vec2)
ptpdata2 <- rename(ptpdata2, deliverytime = best)
ptpdata <- rbind(ptpdata1, ptpdata2)
#---------------------------------------------------------------#
ptpmeandelivtime <- ptpdata %>%
group_by(datalabel) %>%
summarize(mean=mean(deliverytime))
ptpmeandelivtime
